{"version":3,"file":"src_app_attend_attend_module_ts.js","mappings":"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","sources":["./src/app/attend/attend-data.model.ts","./src/app/attend/attend-routing.module.ts","./src/app/attend/attend.module.ts","./src/app/attend/attend.page.ts","./src/app/attend/attend.service.ts","./src/app/attend/attend.page.html"],"sourcesContent":["export class AttendData{\n\n  constructor(\n    public id: string,\n    public locationImage: string,\n    public locationDate: string,\n    public locationTitle: string,\n    public locationGenre: string,\n    public locationPrice: number,\n    public locationId: string,\n    public userId: string,\n    ){}\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { AttendPage } from './attend.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: AttendPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class AttendPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { AttendPageRoutingModule } from './attend-routing.module';\n\nimport { AttendPage } from './attend.page';\nimport { ConfirmAttendComponent } from './confirm-attend/confirm-attend.component';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    AttendPageRoutingModule\n  ],\n  declarations: [\n    AttendPage,\n    //ConfirmAttendComponent\n  ]\n})\nexport class AttendPageModule {}\n","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { IonItemSliding } from '@ionic/angular';\nimport { Subscription } from 'rxjs';\nimport { AttendData } from './attend-data.model';\nimport { AttendService } from './attend.service';\n\n@Component({\n  selector: 'app-attend',\n  templateUrl: './attend.page.html',\n  styleUrls: ['./attend.page.scss'],\n})\nexport class AttendPage implements OnInit, OnDestroy {\n  isLoading = false;\n  embeddedAttends: AttendData[];\n  private attendSubscription: Subscription\n\n  constructor(private attendService: AttendService) { }\n\n  ngOnInit() {\n    this.attendService.attend.subscribe(attend =>{\n      this.embeddedAttends = attend;\n\n    });\n  }\n  ionViewWillEnter(){\n    this.isLoading = true;\n    this.attendService.getDbAttendData().subscribe(() =>{\n      this.isLoading=false;\n    });\n  }\n\n  onCancelAttend(attendId:string, itemSliding: IonItemSliding){\n    itemSliding.close();\n    this.attendService.cancelAttend(attendId).subscribe();\n    console.log('Die Absage ist eingegangen!');\n  }\n  ngOnDestroy() {\n    if (this.attendSubscription) {\n      this.attendSubscription.unsubscribe();\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { BehaviorSubject } from 'rxjs';\nimport { map, switchMap, take, tap } from 'rxjs/operators';\nimport { AuthenticationService } from '../authentication/authentication.service';\nimport { AttendData } from './attend-data.model';\n\ninterface AttendDatas {\n  locationDate: string;\n  locationGenre: string;\n  locationId: string;\n  locationImage: string;\n  locationPrice: number;\n  locationTitle: string;\n  userId:string;\n}\n\n@Injectable({ providedIn: 'root' })\nexport class AttendService {\n  private _attend = new BehaviorSubject<AttendData[]>([]);\n\n  get attend() {\n    return this._attend.asObservable();\n  }\n  constructor(\n    private authenticationService: AuthenticationService,\n    private httpClient: HttpClient\n  ) {}\n\n  confirmAttend(\n    locationId: string,\n    locatonImage: string,\n    locationDate: string,\n    locationTitle: string,\n    locationGenre: string,\n    locationPrice: number\n  ) {\n    let generatedId: string;\n    const newAttendData = new AttendData(\n      Math.random().toString(),\n      locatonImage,\n      locationDate,\n      locationTitle,\n      locationGenre,\n      locationPrice,\n      locationId,\n      this.authenticationService.userId\n    );\n    return this.httpClient\n      .post<{ name: string }>(\n        'https://eh-eventhour-default-rtdb.europe-west1.firebasedatabase.app/attendData.json',\n        { ...newAttendData, id: null }\n      )\n      .subscribe((data) => {\n        newAttendData.id = data.name;\n        this._attend.next(Object.values(this.attend).concat(newAttendData));\n      });\n  }\n\n  getDbAttendData() {\n    \n    return this.httpClient\n      .get<{ [key: string]: AttendDatas }>(\n        `https://eh-eventhour-default-rtdb.europe-west1.firebasedatabase.app/attendData.json?orderBy=\"userId\"&equalTo=\"${\n          this.authenticationService.userId\n        }\"`\n      )\n      .pipe(\n        map((responseData) => {\n          const attends = [];\n          for (const key in responseData) {\n            if (responseData.hasOwnProperty(key)) {\n                attends.push(\n                new AttendData(\n                  key,\n                  responseData[key].locationImage,\n                  responseData[key].locationDate,\n                  responseData[key].locationTitle,\n                  responseData[key].locationGenre,\n                  responseData[key].locationPrice,\n                  responseData[key].locationId,\n                  responseData[key].userId,\n                )\n              );\n            }\n          }\n          return attends;\n          // return [];\n        }),\n        tap((attends) => {\n          this._attend.next(attends);\n        })\n      );\n  }\n\n  cancelAttend(attendId: string) {\n    return this.httpClient\n      .delete(\n        `https://eh-eventhour-default-rtdb.europe-west1.firebasedatabase.app/attendData/${attendId}.json`\n      )\n      .pipe(\n        switchMap(() => {\n          return this.attend;\n        }),\n        take(1),\n        tap(attend => {\n          this._attend.next(attend.filter(a => a.id !== attendId));\n        })\n      );\n  }\n}\n","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-title>Deine Events</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <ion-grid>\\n    <ion-row>\\n      <ion-col *ngIf=\\\"!isLoading && (!embeddedAttends || embeddedAttends.length <= 0)\\\">\\n        <p class=\\\"ion-text-center\\\">Momentan ist kein Eventbesuch geplant.</p>\\n      </ion-col>\\n      <ion-col *ngIf=\\\"!isLoading && embeddedAttends && embeddedAttends.length > 0\\\">\\n        <ion-list>\\n          <ion-item-sliding *ngFor=\\\"let embeddedAttend of embeddedAttends\\\" #itemSliding>\\n\\n\\n\\n            <ion-item>\\n              <ion-col size=\\\"3\\\"><ion-img [src]=\\\"embeddedAttend.locationImage\\\"></ion-img></ion-col>\\n              <ion-col size=\\\"9\\\">\\n                <ion-label class=\\\"spacing\\\">\\n                  <h5>{{embeddedAttend.locationTitle}}</h5>\\n                  <p>{{embeddedAttend.locationDate}}</p>\\n                  <p>{{embeddedAttend.locationPrice}} €</p>\\n                  <ion-button class=\\\"listing-btn\\\" [routerLink]=\\\"['/search/' + embeddedAttend.locationId]\\\"> Mehr Infos</ion-button>\\n                </ion-label>\\n              </ion-col>\\n            </ion-item>\\n            <ion-item-options>\\n              <ion-item-option color=\\\"danger\\\" (click)=\\\"onCancelAttend(embeddedAttend.id, itemSliding)\\\">\\n                <ion-icon name=\\\"trash-outline\\\"></ion-icon>\\n              </ion-item-option>\\n            </ion-item-options>\\n          </ion-item-sliding>\\n        </ion-list>\\n      </ion-col>\\n    </ion-row>\\n  </ion-grid>\\n</ion-content>\\n\";"],"names":[],"sourceRoot":"webpack:///"}